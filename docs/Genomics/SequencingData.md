## Sequencing Data

Sequence data from high throughput technologies can be stored in multiple formats. This data includes the sequencing **bases** as well as the **quality** scores associated with these bases.  Some formats merge these two types of data in a single file.

### FASTA format

```
>BOSS_DROM Bride of Sevenless [Drosophila melanogaster]
MXXXXX
ASASDASD
```

One of the simplest ways to store/encode sequence data in a text file is the FASTA format. Named for the program suite which first introduced the file format, FastA (William Pearson). The data are encoded in a simple format where the character `>` indicates the beginning of a sequence record. Followed by an identifier - eg `>BOSS_DROME Bride of Sevenless [Drosophila melanogaster]` is a sequence record with the identifier is **BOSS_DROME** while everything that follows is a comment or description.  

**Identifiers.** Some data providers encode information in these identifiers with varying ways of delimiting the data. For example NCBI/EMBL/DDBJ have used the format `>gi|1234|gb|BBD123|XM_123345.1` which indicates there are multiple identifiers associated with this record. One is a GI - "Genbank Identifier", one is an accession number - *BDD123* which was generated by NCBI Genbank (based on the 'gb'), and there is a locus name or secondary accession associated which has a version number (version 1) - `XM_123345.1`. There are multiple data providers - ddbj and emb for DDBJ and EMBL.  For protein records that have been curated by [Swissprot](http://www.swissprot.org) these will use the `sp`.  

GenBank has done away with the genbank identifiers (gi|1234) so these will not be part of current database releases but I mention here if you see older datasets and wonder what these mean.

**Sequence data.** Sequence data is stored in this format as the rest of the record file. This can be formatted to look nice with regular line breaks (typically 60 characters given most width of terminals). The sequence can also appear with no line breaks and be on one long line. This is often convenient for many of the tools which like to have one line for description and one line for sequence. It can save space in file too since a file with hundreds of millions of sequences will be smaller if an uneeded character appearing every 60 bases is not included. (1 character = 1 byte, if there are 10 Million sequences, and with 1 extra line break occurs in a 100 bp sequence  = 10M extra characters or 10M bytes == 10 Megabytes)

This file format is simple and compact and multiple sequences can be encoded in a single file. The end of a sequence is the determined by the presence of a `>` marking the start of a new record, or the end of a file.

This file format can be used to store DNA or protein files. Since it is a text format encoding of wobble or uncertainty of bases can also be included - for example the character `W` is used to represent either `A` or `T` in DNA, when there is uncertainty in the quality of a base or if trying to encode the two possible alleles observed as heterozygous SNPs in an individual.

**Using FASTA Files.** Since this file format is so simple it is easy to use UNIX tools to calculate some statistics about them. For example, the number of sequences can be counted by running the following grep command.
```bash
$ grep -c '^>' myfile.fasta
```
The `^>` means match lines that start with `>`, it can also be achieved just using `grep -c '>' `. The `-c` means count the number of lines which match the pattern and return the count not the lines themselves.
You can also count the number of lines using the `wc` (word count) command.
```bash
$ grep '^>' myfile.fasta | wc -l
```

If you wanted to count the number of residues or nucleotide bases in a file you can use grep to skip the lines which are identifiers and then strip off the white space (eg spaces or newlines are ignored) and count the total length of the sequence. The `grep -v` command means show only lines which DO NOT match the pattern. The `sed` command support text translation and manipulation with [regular expressions](http://REGULAREXPRESSIONSWIKI). The `wc -c` reports the number of characters instead of number of lines.

```bash
$ grep -v '^>' | seq 's/\s//g | wc -c'
```

### FASTQ format

```
@HBC
AACAGATAH
COMMENT
!!XXX
```

This file format contains sequence data along with the per base quality scores. This is typically what you will receive from a sequencing center, company, or what you can download from NCBI, EBI Short Read Archives.


## Downloading data

Access to sites can through web or ftp links or in some cases on a hard drive sent directly to you.
To put these data on the server for processing you will need to copy it over.

**Command line FTP** This is the most common way still to access data. The large database of sequences at NCBI Genbank are accessed this way typically.  There are several command line tools useful for retrieving these file.

`curl` is a typical tool install on OSX, UNIX. It is a command line URL retriever. Here are some example usage.

```bash
$ curl ftp://ftp.ncbi.nih.gov/blast/db/FASTA/yeast.nt.gz
```

## Data Compression

Data files are large, with the billions of bases available in the global sequence databases and or in a single Illumina sequencing lane.  Several tools are used to compress these files and the extension of the files tells you what tool was used to create it or will be needed to uncompress it.

# Short Read data
